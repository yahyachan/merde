# 中期考核
## 题目：可扩展的静态类型函数式语言 merde
我们这里计划实现一个可扩展的类 ML 静态类型函数式语言。这里可扩展指的是语言中的复合结构（如结构体或者类）易于扩展，可以动态的在其中加入、删除一个字段，但同时又能用静态类型系统在编译时确保类型安全。作为函数式语言，我们肯定会支持高阶函数，同时鼓励用户尽量写无副作用的代码，但也不排斥副作用，计划用 algebraic effects 式的方案实现副作用管理。此外我们还计划实现强大的类型推导，使得用户可以在几乎不标注任何变量、函数参数、函数返回值的情况下能让类型推导器推出所有类型（也就是所谓全局类型推导），但这里强大类型推导又不会过多的约束类型系统的表达力，类型系统将支持可扩展的类型特性以及基础的泛型。

至于语言的实现，将会包括一个 REPL 式的交互解释器以及一个简单的编译器。

## 分工
- 湛忠胜：语言设计，提出核心思路及代码实现。
- 叶文：编写测试。
- 郭明昊：整理文档，实现优化。

## 设计
设计上包括词法分析、语法分析、双向类型检查（这里类型推导和类型检查在同一过程中进行，故称双向类型检查）、解释、编译五大模块组成。词法分析直接用`ocamllex`生成，语法分析用`menhir`这一$\mathrm{LR}(1)$生成器生成。

不考虑类型系统的话，语言本身设计没有太多复杂的：也就是围绕基础类型的运算，条件判断，局部变量（let 结构），高阶函数及其调用，递归，复合结构相关的操作（读取、加入、删除、替换字段）。

类型系统的话，我们的基础是经典的 Hindley-Milner 类型系统，这一类型系统能方便的支持全局类型推导，但是也能支持基本泛型（也就是 let-polymorphism）等高级特性。为了在类型系统层面支持可扩展编程，我们引入了 row polymorphism 的扩展，具体设计采用 Daan Leijen 在 2005 年发表的论文 Extensible records with scoped labels 中的方案，能非常好的融入 HM 类型系统而不破坏其本来的特性，对类型推导也颇为友好。实际实现里为了优化类型推导中合一的性能，需要用并查集这一数据结构。

解释器实现用的是经典的`eval/apply`模式。编译器目前不计划实现复杂的编译优化，只是简单地将语言翻译成某一种 IR。

## 实现

## 展示

